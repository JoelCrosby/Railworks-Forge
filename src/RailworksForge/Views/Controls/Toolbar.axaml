<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:RailworksForge.ViewModels"
             xmlns:lucideAvalonia="clr-namespace:LucideAvalonia;assembly=LucideAvalonia"
             xmlns:translations="clr-namespace:RailworksForge.Translations;assembly=RailworksForge.Translations"
             xmlns:echoes="clr-namespace:Echoes;assembly=Echoes.Avalonia"
             xmlns:menuItems="clr-namespace:RailworksForge.ViewModels.MenuItems"
             xmlns:controls="clr-namespace:RailworksForge.Views.Controls"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="48"
             x:Class="RailworksForge.Views.Controls.Toolbar"
             x:CompileBindings="True"
             x:DataType="vm:ToolbarViewModel">

    <Design.DataContext>
        <vm:DesignToolbarViewModel />
    </Design.DataContext>

    <UserControl.Styles>
        <Style Selector="TextBlock">
            <Setter Property="FontSize" Value="18" />
        </Style>

        <Style Selector="Button">
            <Setter Property="FontSize" Value="16" />
            <Setter Property="Background" Value="{DynamicResource SystemBaseLowColor}" />
            <Setter Property="Foreground" Value="{DynamicResource SystemBaseHighColor}" />
        </Style>
    </UserControl.Styles>

    <Border Padding="6,4" Height="48" BorderThickness="0,0,0,1" BorderBrush="{DynamicResource SystemChromeDisabledHighColor}">
        <StackPanel Orientation="Horizontal" Spacing="12">
            <Button Command="{Binding SettingsClickedCommand}" ToolTip.Tip="{echoes:Translate {x:Static translations:Strings.settings}}">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <lucideAvalonia:Lucide Icon="Settings" StrokeBrush="{DynamicResource TextControlForeground}" StrokeThickness="2" Width="18" Height="18" />
                </StackPanel>
            </Button>

            <Button Command="{Binding OpenSettingsDirectoryCommand}" ToolTip.Tip="{echoes:Translate {x:Static translations:Strings.open_settings_folder}}">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <lucideAvalonia:Lucide Icon="FolderOpen" StrokeBrush="{DynamicResource TextControlForeground}" StrokeThickness="2" Width="18" Height="18" />
                </StackPanel>
            </Button>

            <Button Command="{Binding InstallPackageCommand}" ToolTip.Tip="{echoes:Translate {x:Static translations:Strings.install_package}}">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <lucideAvalonia:Lucide Icon="Package" StrokeBrush="{DynamicResource TextControlForeground}" StrokeThickness="2" Width="18" Height="18" />
                </StackPanel>
            </Button>

            <SplitButton Content="{echoes:Translate {x:Static translations:Strings.convert_bin_to_xml}}"
                         Command="{Binding ConvertBinToXmlCommand}">
                <SplitButton.Flyout>
                    <MenuFlyout Placement="RightEdgeAlignedTop">
                        <MenuItem Header="{echoes:Translate {x:Static translations:Strings.convert_xml_to_bin}}"
                                  Command="{Binding ConvertXmlToBinCommand}" />
                    </MenuFlyout>
                </SplitButton.Flyout>
            </SplitButton>

            <SplitButton Content="{Binding SelectedLanguage}">
                <SplitButton.Flyout>
                        <MenuFlyout ItemsSource="{Binding Cultures}" >
                            <MenuFlyout.ItemContainerTheme>
                                <ControlTheme TargetType="MenuItem"
                                              BasedOn="{StaticResource {x:Type MenuItem}}"
                                              x:DataType="menuItems:CultureMenuItem">

                                    <Setter Property="Header" Value="{Binding Header}"/>
                                    <Setter Property="Command" Value="{Binding $parent[controls:Toolbar].((vm:ToolbarViewModel)DataContext).ChangeLanguageCommand}" />
                                    <Setter Property="CommandParameter" Value="{Binding}" />
                                </ControlTheme>
                            </MenuFlyout.ItemContainerTheme>

                        </MenuFlyout>
                </SplitButton.Flyout>
            </SplitButton>

        </StackPanel>
    </Border>
</UserControl>
